# Migration `20200816210019`

This migration has been generated by Conner Petzold at 8/16/2020, 9:00:19 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Player" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"discordId" text  NOT NULL ,"discriminator" text  NOT NULL ,"id" text  NOT NULL ,"points" integer  NOT NULL DEFAULT 0,"refreshToken" text  NOT NULL ,"token" text  NOT NULL ,"tokenExpires" timestamp(3)  NOT NULL ,"username" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Match" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"id" text  NOT NULL ,"reportedAt" timestamp(3)   ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."MatchesOnPlayers" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"matchId" text  NOT NULL ,"playerId" text  NOT NULL ,"won" boolean  NOT NULL ,
    PRIMARY KEY ("playerId","matchId"))

CREATE UNIQUE INDEX "Player.discordId" ON "public"."Player"("discordId")

ALTER TABLE "public"."MatchesOnPlayers" ADD FOREIGN KEY ("playerId")REFERENCES "public"."Player"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."MatchesOnPlayers" ADD FOREIGN KEY ("matchId")REFERENCES "public"."Match"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200816210019
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,39 @@
+datasource db {
+  provider = "postgresql"
+  url      = env("DATABASE_URL")
+}
+
+generator prisma_client {
+  provider = "prisma-client-js"
+}
+
+model Player {
+  id            String             @default(uuid()) @id
+  createdAt     DateTime           @default(now())
+  discordId     String             @unique
+  token         String
+  refreshToken  String
+  tokenExpires  DateTime
+  username      String
+  discriminator String
+  matches       MatchesOnPlayers[]
+  points        Int                @default(0)
+}
+
+model Match {
+  id         String             @default(uuid()) @id
+  createdAt  DateTime           @default(now())
+  reportedAt DateTime?
+  players    MatchesOnPlayers[]
+}
+
+model MatchesOnPlayers {
+  player    Player   @relation(fields: [playerId], references: [id])
+  playerId  String
+  match     Match    @relation(fields: [matchId], references: [id])
+  matchId   String
+  createdAt DateTime @default(now())
+  won       Boolean
+
+  @@id([playerId, matchId])
+}
```


